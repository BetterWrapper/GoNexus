<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
        <link rel="dns-prefetch" href="/">
        <title>Create - GoNexus</title>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="/ui/css/common_combined.css" rel="stylesheet" type="text/css">
        <link href="/ui/css/videomaker.css" rel="stylesheet" type="text/css">
        <script src="/js/common_combined.js"></script>
        <style>
            #other-options,
            #studio-eras {
                display: grid;
                grid-template-columns: auto auto auto auto;
                gap: 10px;
                padding: 10px;
            }
            #grid-item,
            .studio-build {
                background-color: rgba(255, 255, 255, 0.8);
                text-align: center;
                font-size: 30px;
            }
            .studio-build-active {
                background-color: rgb(0, 38, 255);
                text-align: center;
                font-size: 30px;
            }
            @font-face {
                font-family: 'Lato';
                font-style: normal;
                font-weight: 400;
                src: local('Lato Regular'), local('Lato-Regular'), url(/ui/fonts/qIIYRU-oROkIk8vfvxw6QvesZW2xOQ-xsNqO47m55DA.woff) format('woff');
            }
            @font-face {
                font-family: 'Lato';
                font-style: normal;
                font-weight: 700;
                src: local('Lato Bold'), local('Lato-Bold'), url(/ui/fonts/qdgUG4U09HnJwhYI-uK18wLUuEpTyoUstqEm5AMlJo4.woff) format('woff');
            }
        </style>
    </head>
    <body class="page-action-videomaker">
        <div class="modal" id="createOverlay">
            <div class="modal-dialog modal-lg">
                <form class="modal-content" action="javascript:;" id="createVideoForm">
                    <center class="modal-header">
                        <button type="button" class="close" data-dismiss="modal">
                            <span aria-hidden="true">&times;</span>
                            <span class="sr-only">Close</span>
                        </button>
                        <h2 class="modal-title">Select a Video Maker</h2>
                    </center>
                    <center id="studio-eras" class="modal-body">
                        <a href="javascript:;" id="studio2011" onclick="selectLVM('2011')" class="studio-build">
                            <img src="/ui/img/2011.png" width="120">
                            <h2>2011</h2>
                        </a>
                        <a href="javascript:;" id="studio2012" onclick="selectLVM('2012')" class="studio-build">
                            <img src="/ui/img/2012.png" width="120">
                            <h2>2012</h2>
                        </a>
                        <a href="javascript:;" id="studio2013" onclick="selectLVM('2013')" class="studio-build">
                            <img src="/ui/img/2013.png" width="120">
                            <h2>2013</h2>
                        </a>
                        <a href="javascript:;" id="studio2015" onclick="selectLVM('2015')" class="studio-build">
                            <img src="/ui/img/2015.png" width="120">
                            <h2>2015</h2>
                        </a>
                        <a href="javascript:;" id="studio2016" onclick="selectLVM('2016')" class="studio-build-active">
                            <img src="/ui/img/2016.png" width="120">
                            <h2>GoNexus Studio</h2>
                        </a>
                        <a href="javascript:;" id="studio2017" onclick="selectLVM('2017')" class="studio-build">
                            <img src="/ui/img/2017.png" width="120">
                            <h2>2017</h2>
                        </a>
                        <a href="javascript:;" id="studio2018" onclick="selectLVM('2018')" class="studio-build">
                            <img src="/ui/img/2018.png" width="120">
                            <h2>2018</h2>
                        </a>
                        <a href="javascript:;" id="studio2019" onclick="selectLVM('2019')" class="studio-build">
                            <img src="/ui/img/2019.png" width="120">
                            <h2>2019</h2>
                        </a>
                    </center>
                    <center class="modal-footer">
                        <h2>Other options</h2>
                        <div id="other-options">
                            <p id="grid-item">Tutorial <input type="checkbox" name="tutorial"></p>
                            <p id="grid-item">Widescreen <input type="checkbox" name="widescreen" checked></p>
                        </div>
                        <div id="ct2011" style="display: none;">
                            <p>Color Theme</p>
                            <select name="ct2011">
                                <option value="silver">Dark</option>
                                <option value="go" selected>Silver</option>
                            </select>
                        </div>
                        <div id="ct2012" style="display: none;">
                            <p>Color Theme</p>
                            <select name="ct2012">
                                <option value="go">Dark</option>
                                <option value="silver" selected>Silver</option>
                            </select>
                        </div><br>
                        <button type="submit" class="btn btn-orange">Create a Video</button>
                    </center>
                </form>
            </div>
        </div>
        <div class="modal" id="studioBlock">
            <div class="modal-dialog modal-lg" style="width: 991px;">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" id="closeStudio">
                            <span aria-hidden="true">&times;</span>
                            <span class="sr-only">Close</span>
                        </button>
                        <h2 class="modal-title"><span class="year"></span> Video Maker</h2>
                    </div>
                    <div class="modal-body" id="studiodiv">You need Adobe Flash Player in order to use the <span class="year"></span> Video Maker</div>
                </div>
            </div>
        </div>
        <%- include("includes/header.ejs", {
            isVideoList: true
        }) %>
        <div class="container">
            <div class="create-header">
                <h1 class="h3">Select a Theme</h1>
            </div>
            <div class="themes row" id="themes" data-row-1></div>
            <div class="themes row" id="themes" data-row-2></div>
        </div>
        <script src="https://fireanimate-eb62d.firebaseapp.com/__/firebase/6.2.4/firebase-app.js"></script>
        <script src="https://fireanimate-eb62d.firebaseapp.com/__/firebase/6.2.4/firebase-auth.js"></script>
        <script src="https://fireanimate-eb62d.firebaseapp.com/__/firebase/init.js"></script>
        <script src="/js/user.js"></script>
        <script>
            let tId;
            let studio = "2016";
            jQuery.getJSON("/api/themes/get", (d) => {
                let count = 0;
                for (const theme of d) {
                    if (count < 3) $("[data-row-1]").append(`<div class="col-sm-6 col-md-4 col-lg-4"><div class="theme" id="thm-${theme.attr.id}"><div class="theme-cell"><div class="theme-cover launch">
                        <img src="https://raw.githubusercontent.com/Wrapper-Offline/Wrapper-Offline/main/server/pages/img/themes/${theme.attr.id}.jpg" alt="${theme.attr.name}">
                    </div><div class="theme-meat"><div class="apps"><h3>${theme.attr.name}</h3>
                         <a class="btn btn-orange" href="/go_full?tray=${theme.attr.id}" title="" data-original-title="LVM">Make A Video</a>
                         <a class="btn btn-default" href="javascript:LVMSelector('${theme.attr.id}')" title="" data-original-title="LVM Selector">...</a>
                         ${theme.attr.cc_theme_id ? `<a class="btn btn-default" href="/cc_browser?themeId=${theme.attr.cc_theme_id}" title="" data-original-title="Character Creator"><i class="i-cc"></i></a>` : ''}
                         ${theme.attr.id == "custom" ? `<a class="btn btn-default" href="/quickvideo?filename=everydaylife" title="" data-original-title="QVM Template"><i class="i-qvm"></i></a>` : theme.attr.id == "action" ? `<a class="btn btn-default" href="/quickvideo?filename=basketball" title="" data-original-title="QVM Template"><i class="i-qvm"></i></a>` : ''}
                    </div>
                    </div></div></div></div>`);
                    else if (count < 6) $("[data-row-2]").append(`<div class="col-sm-6 col-md-4 col-lg-4"><div class="theme" id="thm-${theme.attr.id}"><div class="theme-cell"><div class="theme-cover launch">
                        <img src="https://raw.githubusercontent.com/Wrapper-Offline/Wrapper-Offline/main/server/pages/img/themes/${theme.attr.id}.jpg" alt="${theme.attr.name}">
                    </div><div class="theme-meat"><div class="apps"><h3>${theme.attr.name}</h3>
                        <a class="btn btn-orange" href="/go_full?tray=${theme.attr.id}" title="" data-original-title="LVM">Make A Video</a>
                        <a class="btn btn-default" href="javascript:LVMSelector('${theme.attr.id}')" title="" data-original-title="LVM Selector">...</a>
                        ${theme.attr.cc_theme_id ? `<a class="btn btn-default" href="/cc_browser?themeId=${theme.attr.cc_theme_id}" title="" data-original-title="Character Creator"><i class="i-cc"></i></a>` : ''}
                        ${theme.attr.id == "custom" ? `<a class="btn btn-default" href="/quickvideo?filename=everydaylife" title="" data-original-title="QVM Template"><i class="i-qvm"></i></a>` : theme.attr.id == "action" ? `<a class="btn btn-default" href="/quickvideo?filename=basketball" title="" data-original-title="QVM Template"><i class="i-qvm"></i></a>` : ''}
                    </div></div></div></div></div>`);
                    count++
                }
            });
            function LVMSelector(themeId) {
                tId = themeId;
                $("#createOverlay").modal({
                    keyboard: false,
                    backdrop: "static"
                })
            }
            function selectLVM(year) {
                studio = year;
                $(".studio-build-active").addClass("studio-build").removeClass("studio-build-active");
                $(`#studio${year}`).addClass("studio-build-active").removeClass("studio-build");
                if (year == '2011') {
                    $("#ct2011").show();
                    $("#ct2012").hide();
                } else if (year == '2012' || year == '2013') {
                    $("#ct2011").hide();
                    $("#ct2012").show();
                } else {
                    $("#ct2011").hide();
                    $("#ct2012").hide();
                }
            }
            $("#createVideoForm").submit(() => {
                const json = Object.fromEntries(new URLSearchParams($("#createVideoForm").serialize()));
                if (studio == '2011' || studio == '2012' || studio == '2013') {
                    $(".year").text(studio);
                    window.onbeforeunload = function(e) {
                        var e = e || window.event;
                        if (e) e.returnValue = 'You are about to lose all your unsaved changes in the studio.';
                    };
                    jQuery("#studiodiv").flash({
                        id: "Studio",
                        swf: `/static/${studio == '2013' ? '2012/477' : `${studio}/animation`}/go_full.swf`,
                        width: "960",
                        height: "630",
                        align: "middle",
                        allowScriptAccess: "always",
                        allowFullScreen: "true",
                        wmode: "window",
                        hasVersion: "10.3",
                        flashvars: {
                            apiserver: "/",
                            storePath: "/static/2011/store/<store>",
                            isEmbed: 1,
                            ctc: "go",
                            ut: 23,
                            tm: json.tutorial ? "NEW" : "FIN",
                            appCode: "go",
                            tray: tId,
                            siteId: "go",
                            lid: 13,
                            isLogin: "Y",
                            retut: 1,
                            clientThemePath: `/static/${studio != '2011' ? '2012/477' : '2011'}/<client_theme>?themeColor=${studio == '2011' ? json.ct2011 : json.ct2012}`,
                            themeId: "business",
                            tlang: "en_US",
                            studio,
                            userId: userData.uid || userData.id,
                            isWide: json.widescreen ? 1 : 0,
                            collab: 0,
                            nextUrl: "/api/redirect",
                        }
                    });
                    $("#createOverlay").modal('hide');
                    $("#studioBlock").modal({
                        keyboard: false,
                        backdrop: "static"
                    });
                } else location.href = `/go_full?y=${studio}&isWide=${json.widescreen == "on" ? '1' : '0'}&tutorial=${json.tutorial == "on"}&tray=${tId}`
                $("#closeStudio").click(() => {
                    const yesorno = confirm(`Before you leave the ${studio} studio, please save any changes that you made to your video.`)
                    if (yesorno) {
                        $("#studioBlock").modal('hide');
                        window.onbeforeunload = function(e) {
                            return null;
                        };
                    }
                });
            })
        </script>
        <%- include("includes/footer.ejs") %>
    </body>
</html>
